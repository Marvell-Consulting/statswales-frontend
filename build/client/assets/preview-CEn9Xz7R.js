import{w as _}from"./with-props-daUcymKh.js";import{j as e}from"./context-Zvpbq3dQ.js";import{E as f}from"./ErrorHandler-Dy9h9pDk.js";import{P as k}from"./Pagination-CTQ2at6l.js";import{R as w}from"./RadioGroup-DktJgkR6.js";import{S as N}from"./Select-DL5FhX3p.js";import{u as y,T as i}from"./T-CQIXqhPq.js";import{T as z}from"./Table-BHT1KmCI.js";import{E as C}from"./ErrorProvider-Cxuz4RMS.js";import{F as E}from"./chunk-DQRVZFIR-CI4QRDf9.js";import{l as F}from"./locale-url-yD_AyXRN.js";import"./clsx-B-dksMZM.js";import"./LocaleLink-CIhOCkNj.js";var o=(n=>(n.Unknown="unknown",n.Dimension="dimension",n.Measure="measure",n.DataValues="data_values",n.NoteCodes="note_codes",n.Ignore="ignore",n.LineNumber="line_number",n))(o||{});const J=_(function({loaderData:s}){var t,u,c,a,d,m,p,g;const{i18n:h}=y(),v=s.revisit&&((t=s.dataset)==null?void 0:t.id)&&F(`/publish/${(u=s.dataset)==null?void 0:u.id}/tasklist`,h.language);s.revisit;const x=e.jsx(e.Fragment,{children:(c=s.headers)==null?void 0:c.map((r,l)=>e.jsx("col",{className:r.source_type==="ignore"?"ignore-column":""},l))}),j=(a=s.headers)==null?void 0:a.map((r,l)=>({key:l,label:r.source_type===o.LineNumber?e.jsx("span",{className:"govuk-visually-hidden",children:e.jsx(i,{children:"publish.preview.row_number"})}):(()=>{const b=r.source_type&&r.source_type!==o.Unknown?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"region-subhead",children:e.jsxs(i,{children:["publish.preview.source_type.",r.source_type]})}),e.jsx("br",{})]}):null;return e.jsxs("div",{children:[b,e.jsx("span",{children:r.name||e.jsx(i,{colNum:l+1,children:"publish.preview.unnamed_column"})})]})})(),cellClassNameName:r.source_type}));return e.jsxs(C,{children:[e.jsx("h1",{className:"govuk-heading-xl",children:e.jsx(i,{children:s.revisit?"publish.preview.heading_summary":"publish.preview.heading"})}),e.jsx(f,{}),e.jsxs("div",{className:"govuk-grid-row",children:[e.jsx("div",{className:"govuk-grid-column-one-half",style:{paddingTop:"7px"},children:e.jsx("p",{className:"govuk-body",children:s.revisit?e.jsx(i,{cols:(((d=s.headers)==null?void 0:d.length)||0)-s.ignoredCount,rows:(m=s.page_info)==null?void 0:m.total_records,ignored:s.ignoredCount,children:"publish.preview.upload_summary"}):e.jsx(i,{cols:((p=s.headers)==null?void 0:p.length)||0,rows:(g=s.page_info)==null?void 0:g.total_records,children:"publish.preview.preview_summary"})})}),e.jsx("div",{className:"govuk-grid-column-one-half",style:{textAlign:"right"},children:e.jsxs(E,{role:"page-size",className:"govuk-!-margin-bottom-0",children:[e.jsx(N,{name:"page_size",label:e.jsx(i,{children:"pagination.page_size"}),options:[5,10,25,50,100,250,500],value:s.page_size?String(s.page_size):void 0,inline:!0})," ",e.jsx("input",{type:"hidden",name:"file",value:s.datafile_id}),e.jsx("input",{type:"hidden",name:"page_number",value:"1"}),e.jsx("button",{type:"submit",className:"govuk-button govuk-button-small govuk-!-display-inline","data-module":"govuk-button",children:e.jsx(i,{children:"pagination.update"})})]})})]}),s.data&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"govuk-grid-row",children:e.jsx("div",{className:"govuk-grid-column-full with-overflow",children:e.jsx(z,{isSticky:!0,columns:j,rows:s.data,colgroup:x})})}),e.jsx(k,{total_pages:s.total_pages,current_page:s.current_page,page_size:s.page_size,pagination:s.pagination,page_info:s.page_info}),s.revisit?e.jsx("div",{className:"govuk-grid-row",children:e.jsx("div",{className:"govuk-grid-column-full",children:e.jsxs("form",{method:"post",role:"continue",children:[e.jsx(w,{name:"actionChooser",label:e.jsx(i,{children:"publish.preview.revisit_question"}),options:[{value:"replace-table",label:e.jsx(i,{children:"publish.preview.upload_different"}),hint:e.jsx(i,{children:"publish.preview.upload_different_hint"})},{value:"replace-sources",label:e.jsx(i,{children:"publish.preview.change_source"}),hint:e.jsx(i,{children:"publish.preview.change_source_hint"})}]}),e.jsx("div",{className:"govuk-button-group",children:e.jsx("button",{type:"submit",name:"confirm",value:"true",className:"govuk-button","data-module":"govuk-button",style:{verticalAlign:"unset"},"data-prevent-double-click":"true",children:e.jsx(i,{children:"buttons.continue"})})})]})})}):e.jsx("div",{className:"govuk-grid-row",children:e.jsx("div",{className:"govuk-grid-column-full",children:e.jsx("form",{method:"post",role:"continue",children:e.jsxs("fieldset",{className:"govuk-fieldset",children:[e.jsx("legend",{className:"govuk-fieldset__legend govuk-fieldset__legend--m",children:e.jsx("h2",{className:"govuk-fieldset__heading",children:e.jsx(i,{children:"publish.preview.confirm_correct"})})}),e.jsx("div",{className:"govuk-button-group",children:e.jsx("button",{type:"submit",name:"confirm",value:"true",className:"govuk-button","data-module":"govuk-button",style:{verticalAlign:"unset"},"data-prevent-double-click":"true",children:e.jsx(i,{children:"buttons.continue"})})})]})})})})]})]})});export{J as default};
